# Prompt for Replit Codex Agent

Please refactor the shift interface located in `src/app/shift/ShiftDashboard.tsx` (or equivalent root file) to replace the current view tabs (â€œKanban | List | Calendarâ€) with a smarter layout split by **functional views**.

Create 3 main tabs:

### 1. ğŸ—‚ My Shifts Tab
- Only shows shifts where current user is assigned
- Display with:
  - Shift title
  - Date/time
  - Start Shift / End Shift buttons
  - Create Case Note button
- Shift Action Modal includes:
  - Location Verification (use browser geolocation)
  - Shift Time
  - Optional handover notes
- After "Start Shift" or "End Shift", auto-stamp timestamp and store
- Display in either List or Calendar view (toggle in top right)

### 2. ğŸ“ Requests Tab
- Only visible to Admin/Coordinator roles
- Lists pending shift requests from staff
- Display each shift with:
  - Requesting staff
  - Date/time
  - Accept/Reject buttons
- On Accept: assign shift to staff
- On Reject: delete request
- Use clean card layout with status color tags

### 3. ğŸ¢ All Shifts Tab (for Admins only)
- Show all shifts (filtered by companyId)
- Allow view toggle between List and Calendar
- Daily / Weekly / Fortnightly filter dropdown
- Clicking a shift opens:
  - Edit modal
  - Assign staff/client
  - Archive shift
  - Start/End Shift (for overseeing role)

Add shared utility components:
- `ShiftViewToggle.tsx` for switching Calendar/List
- `ShiftStatusTag.tsx` for color-coded status (unassigned, in-progress, completed)

Ensure:
- All data queries are filtered by `companyId` and, when applicable, `staffId` or `clientId`
- All shift actions respect roles (SupportWorker, TeamLeader, Coordinator, Admin)

Use:
- Tailwind + ShadCN for cards, tabs, and responsive layout
- TanStack Query for fetching
- Form actions via useMutation hooks src/
â””â”€â”€ app/
    â””â”€â”€ shift/
        â”œâ”€â”€ ShiftDashboard.tsx
        â”œâ”€â”€ components/
        â”‚   â”œâ”€â”€ MyShiftsTab.tsx
        â”‚   â”œâ”€â”€ ShiftRequestsTab.tsx
        â”‚   â”œâ”€â”€ AllShiftsTab.tsx
        â”‚   â”œâ”€â”€ ShiftActionModal.tsx
        â”‚   â”œâ”€â”€ ShiftViewToggle.tsx
        â”‚   â””â”€â”€ ShiftStatusTag.tsx
# Prompt for Replit Codex Agent

Please create the following two modals under `src/app/shift/components/`:

### 1. `StartShiftModal.tsx`

This modal should open when a staff clicks â€œStart Shiftâ€ for their assigned shift.

It should:
- Auto-detect and display location using `navigator.geolocation.getCurrentPosition`
- Display shift time: Start/End datetime
- Auto-fill client name using `clientId`
- Dropdown to select "Receiving Handover From" (list of company staff via companyId)
- Textarea: â€œWhat were you told during handover?â€
- Submit button should:
  - Update the shift record with:
    - `startTimestamp`
    - `startLocation`
    - `handoverReceivedFromStaffId`
    - `handoverNotesIn`
    - Set `status` = "in-progress"

### 2. `EndShiftModal.tsx`

Opens when user clicks â€œEnd Shiftâ€ on an in-progress shift.

It should:
- Again verify location
- Show client name, shift time
- Textarea: â€œWhat did you pass on to the next staff?â€
- Optional dropdown: "Handover Given To" (staff from company)
- Submit button should:
  - Update:
    - `endTimestamp`
    - `endLocation`
    - `handoverNotesOut`
    - `handoverGivenToStaffId`
    - Set `status` = "completed"

Common Requirements:
- All modals use ShadCN components
- Location field shows readable address (placeholder or static if reverse geocoding unavailable)
- Role enforcement: Only assigned staff can perform these actions
- All updates must pass `companyId`, `staffId`, and `clientId` for access integrity

Also update:
- `ShiftActionButtons.tsx` to open the correct modal based on shift statussrc/
â””â”€â”€ app/
    â””â”€â”€ shift/
        â””â”€â”€ components/
            â”œâ”€â”€ StartShiftModal.tsx
            â”œâ”€â”€ EndShiftModal.tsx
            â””â”€â”€ ShiftActionButtons.tsx